--I started by doing some data cleansing on SQL, by eliminating the columns that were not being used in the analysis:

ALTER TABLE listings
  DROP column name, last_review, reviews_per_month, license
  
  
  --Grouping by price per neighbourhood_group:
  
  SELECT DISTINCT neighbourhood_group, AVG (price) AS avg_price
  FROM listings
GROUP BY neighbourhood_group
  
  
  --Grouping by neighbourhoods and price:
  
  SELECT DISTINCT neighbourhood, neighbourhood_group, 
AVG (price) OVER (PARTITION BY neighbourhood) AS avg_price
  FROM listings
  ORDER BY neighbourhood_group
  
  
  
  -- Counting number of aibnb per neighbouhood:
  
  SELECT DISTINCT neighbourhood, neighbourhood_group, 
COUNT (id) AS number_of_airbnb
  FROM listings
GROUP BY neighbourhood, neighbourhood_group
HAVING neighbourhood = 'Fort Wadsworth' 
OR neighbourhood = 'Tribeca' 
OR neighbourhood = 'Prospect Park' 
OR neighbourhood = 'Theater District' 
OR neighbourhood = 'Flatiron District' 
OR neighbourhood = 'Midtown' 
OR neighbourhood = 'Port Richmond' 
OR neighbourhood = 'Soho' 
OR neighbourhood = 'Riverdale' 
ORDER BY number_of_airbnb
  
  
-- Counting number of Airbnb per neighbourhood:
SELECT TOP 10 neighbourhood, neighbourhood_group, COUNT (id) AS number_of_airbnb
  FROM listings
  GROUP BY neighbourhood, neighbourhood_group
  HAVING COUNT (id) >= 160
  ORDER BY neighbourhood DESC;
  
  
  -- Price per neighbourhood, considering number of Airbnb available:
  
  SELECT TOP 10 neighbourhood, neighbourhood_group, 
SELECT TOP 10 neighbourhood, neighbourhood_group, 
AVG (price) OVER (PARTITION BY neighbourhood) AS avg_price, COUNT (id) OVER (PARTITION BY neighbourhood) AS number_of_airbnb
  FROM listings
  GROUP BY price, neighbourhood, neighbourhood_group, id
  ORDER BY price DESC
